{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}" />
{% endblock %}

{% block content %}
<div class="dashboard-content">
    <!-- Header -->
    <div class="dashboard-header">
        <h1>üè† Dashboard Overview</h1>
        <p>Welcome back! Here's what's happening at your hotel today - {{ today|date:"F d, Y" }}</p>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid">
        <!-- Occupancy Rate -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon occupancy">üìä</div>
                <div>
                    <div class="kpi-title">Occupancy Rate</div>
                </div>
            </div>
            <div class="occupancy-meter" style="--percentage: {{ occupancy_rate }}">
                <div class="meter-circle">
                    <div class="meter-inner">
                        <div class="meter-percentage">{{ occupancy_rate }}%</div>
                        <div class="meter-label">Occupied</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Total Rooms -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon rooms">üè®</div>
                <div>
                    <div class="kpi-title">Room Status</div>
                </div>
            </div>
            <div class="kpi-value">{{ total_rooms }}</div>
            <div class="kpi-subtitle">Total Rooms</div>
            <div class="room-status-grid">
                <div class="status-item available">
                    <div class="status-number">{{ available_rooms }}</div>
                    <div class="status-label">Available</div>
                </div>
                <div class="status-item occupied">
                    <div class="status-number">{{ occupied_rooms }}</div>
                    <div class="status-label">Occupied</div>
                </div>
                <div class="status-item maintenance">
                    <div class="status-number">{{ maintenance_rooms }}</div>
                    <div class="status-label">Maintenance</div>
                </div>
            </div>
        </div>

        <!-- Bookings Summary -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon revenue">üìä</div>
                <div>
                    <div class="kpi-title">Bookings ({{ current_month }})</div>
                </div>
            </div>
            <div class="kpi-value">{{ this_month_bookings }}</div>
            <div class="kpi-subtitle">
                Total this month
            </div>
        </div>

        <!-- Bookings -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon bookings">üìã</div>
                <div>
                    <div class="kpi-title">Bookings</div>
                </div>
            </div>
            <div class="kpi-value">{{ total_bookings }}</div>
            <div class="kpi-subtitle">Total Bookings</div>
            <div class="quick-stats">
                <div class="stat-item">
                    <div class="stat-value">{{ todays_bookings }}</div>
                    <div class="stat-label">Today</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ this_month_bookings }}</div>
                    <div class="stat-label">This Month</div>
                </div>
            </div>
        </div>

        <!-- Today's Activity -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon checkins">üïê</div>
                <div>
                    <div class="kpi-title">Today's Activity</div>
                </div>
            </div>
            <div class="quick-stats">
                <div class="stat-item">
                    <div class="stat-value">{{ todays_bookings }}</div>
                    <div class="stat-label">New Bookings</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ new_guests_this_month }}</div>
                    <div class="stat-label">New Guests</div>
                </div>
            </div>
        </div>

        <!-- Guests -->
        <div class="kpi-card">
            <div class="kpi-header">
                <div class="kpi-icon guests">üë•</div>
                <div>
                    <div class="kpi-title">Guests</div>
                </div>
            </div>
            <div class="kpi-value">{{ total_guests }}</div>
            <div class="kpi-subtitle">Total Registered</div>
            <div class="quick-stats">
                <div class="stat-item">
                    <div class="stat-value">{{ new_guests_this_month }}</div>
                    <div class="stat-label">New This Month</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ this_month_bookings }}</div>
                    <div class="stat-label">Month Bookings</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Grid -->
    <div class="content-grid">
        <!-- Recent Bookings -->
        <div class="chart-section">
            <h3 class="section-title">üìã Recent Bookings</h3>
            <div class="booking-list">
                {% for booking in recent_bookings %}
                <div class="booking-item">
                    <div>
                        <div class="booking-guest">{{ booking.customer_first_name }} {{ booking.customer_last_name }}</div>
                        <div class="booking-room">{{ booking.room_type.name }} ‚Ä¢ {{ booking.phone_number }}</div>
                        <div style="font-size: 11px; color: #007bff;">{{ booking.email }}</div>
                    </div>
                    <div>
                        <div class="booking-date">{{ booking.booking_date|date:"M d, Y" }}</div>
                        <div class="booking-time">{{ booking.booking_time|time:"H:i" }}</div>
                    </div>
                </div>
                {% empty %}
                <p style="text-align: center; color: #666; padding: 20px;">No recent bookings</p>
                {% endfor %}
            </div>
        </div>

        <!-- Room Type Statistics -->
        <div class="info-section">
            <h3 class="section-title">üè® Room Type Status</h3>
            <div class="booking-list">
                {% for room_stat in room_type_stats %}
                <div class="booking-item">
                    <div>
                        <div class="booking-guest">{{ room_stat.room_type__name }}</div>
                        <div class="booking-room">{{ room_stat.total }} total rooms</div>
                    </div>
                    <div>
                        <div class="booking-date">{{ room_stat.available }} available</div>
                        <div class="booking-time">{{ room_stat.occupied }} occupied</div>
                    </div>
                </div>
                {% empty %}
                <p style="text-align: center; color: #666; padding: 20px;">No room data available</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}